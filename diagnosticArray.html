<html>

<head>
    <!-- include jquery library ... required in the sample -->
    <!-- <script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script> -->
    <script src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="http://cdn.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js">
    </script>

    <!-- include the roslibjs library ... required -->
    <script type="text/javascript" src="http://cdn.robotwebtools.org/roslibjs/current/roslib.min.js">
    </script>



    <script type="text/javascript">
        var ros = new ROSLIB.Ros({
            url: 'ws://localhost:9090' // url to your rosbridge server
            //url: 'ws://192.168.1.2:9090' // url to your rosbridge server
        });

        ros.on('connection', function() {
            console.log('Connected to websocket server.');
        });

        ros.on('error', function(error) {
            console.log('Error connecting to websocket server: ', error);
        });

        ros.on('close', function() {
            console.log('Connection to websocket server closed.');
        });

        var exampleTopic = new ROSLIB.Topic({
            ros: ros,
            name: '/test_topic', // use a sensible namespace
            messageType: 'std_msgs/String' //Create a pose object (geometry_msg(s)/Pose)

        });

        var diagnostics = new ROSLIB.Topic({
            ros: ros,
            name: '/diagnostics_msgs',
            // name: '*/sick_lms_200 (http://192.168.1.2:48290/',
            // name: '*/camera/camera_nodelet_manager (http://192.168.1.2:59716/'
            // name: '* /joystick (http://192.168.1.2:57493/',
            messageType: 'diagnostic_msgs/DiagnosticArray'

        });
        function publishEncoded(topic, obj) {
            var msg = new ROSLIB.Message({

                data: JSON.stringify(obj)
            });
            topic.publish(msg);
        }
        function decodeMessage(msg) {
            return JSON.parse(msg.data);
        }
        diagnostics.subscribe(function(msg) {
            console.log(msg);
            var sick_lms ={}
            msg.sick_lms.byte = "byte";
            msg.sick_lms.message = "message";
            msg.sick_lms.hardware_id = "hardware_id";
            msg.sick_lms.values = {}
            msg.sick_lms.values.key = "key";
            msg.sick_lms.values.value = "value";
          };

          status.msg.sick_lms.values.forEach(function(element){console.log(element); });

          /*
            Object.keys(sick_lms).forEach(function(element);{
            $('#topic_data').text(sick_lms);
            $('#lin1').text(msg.sick_lms.byte);
            $('#lin2').text(msg.sick_lms.message);
            $('#lin3').text(msg.sick_lms.hardware_id);
            $('#lin4').text(msg.sick_lms.values.key);
            $('#lin5').text( msg.sick_lms.values.value);
          });
          */
          for (var key in sick_lms) {
            $('#topic_data').text(sick_lms);
            $('#lin1').text(msg.sick_lms.byte);
            $('#lin2').text(msg.sick_lms.message);
            $('#lin3').text(msg.sick_lms.hardware_id);
            $('#lin4').text(msg.sick_lms.values.key);
            $('#lin5').text( msg.sick_lms.values.value);
        });

        $(document).ready(function() {
            console.log("Hello there!");
        })
    </script>
</head>

<body>

    <div>Topic data: <span id="topic_data"></span></div>
    <br />
    <br />
    <h2>sick_lms</h2>
    <div>byte: <span id="lin1"></span></div>
    <div>message: <span id="lin2"></span></div>
    <div>hardware_id: <span id="lin3"></span></div>
    <div>key: <span id="lin4"></span></div>
    <div>value: <span id="lin5"></span></div>


</body>

</html>
